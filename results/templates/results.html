{% extends "base.html" %}

{% load static %}
{% load custom_date %}
{% load airlines %}
{% load airline_icons %}

{% block csscontent %}
    <link rel="stylesheet" href="{% static "css/lightpick.css" %}" xmlns:v-on="http://www.w3.org/1999/xhtml"
          xmlns:v-on="http://www.w3.org/1999/xhtml">
    <link rel="stylesheet" href="{% static "css/bootstrap-slider.min.css" %}">
    <link rel="stylesheet" href="{% static "css/custom.css" %}">
    <link rel="stylesheet" href="{% static "css/results.css" %}">
{% endblock %}


{% block content %}
    <section class="navbar-section">
        {% include "_includes/navbar.html" %}
    </section>
    <section>
        <div class="container content-holder" style="padding-bottom: 20px;">
            <div class="search_content_box" style="padding-top: 20px; padding-bottom: 20px;">
                {% csrf_token %}
                <div class="row">
                    <div class="container">
                        <div class="col-12 pr-0">
                            <div class="row">
                                <div class="col-12 mt-2 col-md-auto search-column-dropdown">
                                    <img src="{% static "images/icons/arrows_rotating.png" %}">
                                    <input type="text" class="drop_down_btn" readonly data-toggle="dropdown"
                                           aria-haspopup="true"
                                           aria-expanded="false" name="destinationType" id="destinationType"
                                           v-model="form.destinationType"/>

                                    <div class="dropdown-menu">
                                        <a class="dropdown-item drop_down_btn_item" @click="selectDestType(1)">
                                            Return
                                        </a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item drop_down_btn_item" @click="selectDestType(2)">One
                                            way</a>
                                    </div>
                                </div>
                                <div class="col-12 mt-2 col-md-auto search-column-dropdown">
                                    <img src="{% static "images/icons/man_user.png" %}">
                                    <input type="text" class="drop_down_btn" readonly data-toggle="modal"
                                           data-target="#passengersModal"
                                           value="Passengers" name="noOfPassengers" id="noOfPassengers"
                                           v-model="form.noOfPassengers"/>
                                </div>
                                <div class="col-12 mt-2 col-md-auto search-column-dropdown">
                                    <img src="{% static "images/icons/dollar.png" %}">
                                    <input type="text" class="drop_down_btn" readonly data-toggle="dropdown"
                                           aria-haspopup="true" aria-expanded="false" name="seatType" id="seatType"
                                           v-model="form.seatType"/>
                                    <div class="dropdown-menu">
                                        <a class="dropdown-item drop_down_btn_item"
                                           @click="selectSeatType(1)">Economy</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item drop_down_btn_item" @click="selectSeatType(2)">Premium
                                            Economy</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item drop_down_btn_item"
                                           @click="selectSeatType(3)">Business</a>
                                        <div class="dropdown-divider"></div>
                                        <a class="dropdown-item drop_down_btn_item" @click="selectSeatType(4)">First
                                            Class</a>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-4">
                                <div class="col-sm-12 flexed-search-bar pl-0">
                                    <div class="flexed-search-item">
                                        <label class="search_label" @click="openPlaceModal(1)">
                                            <h6>Departure
                                                City :
                                                <input type="text" class="search_input" readonly name="placesFrom"
                                                       id="placesFrom"/>
                                            </h6>
                                        </label>
                                        <img class="icon_repeat" src="{% static "images/repeat.svg" %}"
                                             @click="swapPlaces">
                                    </div>
                                    <div class="flexed-search-item">
                                        <label class="search_label" @click="openPlaceModal(2)">
                                            <h6>
                                                Arrival City :
                                                <input type="text" class="search_input" readonly name="placesTo"
                                                       id="placesTo"/>
                                            </h6>
                                        </label>
                                    </div>
                                    <div class="flexed-search-item">
                                        <label class="search_label">
                                            <h6>Departure
                                                Date :
                                                <input type="text" name="dep_date" id="departure_date"
                                                       class="search_input">
                                            </h6>
                                        </label>
                                    </div>
                                    <div class="flexed-search-item">
                                        <label class="search_label">
                                            <h6 style="font-family: karla; font-weight:bold; opacity: .5;">Return Date :
                                                <input type="text" name="ret_date" id="return_date"
                                                       class="search_input">
                                            </h6>
                                        </label>
                                    </div>
                                    <div class="flexed-search-item">
                                        <button class="search_btn"
                                                @click="search">Search
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row">
                    <div class="col-md-12 mb-3">
                        <label class="mr-3"> <strong>Stops: </strong></label>
                        <div class="divider-30 d-block d-md-none"></div>
                        <div class="form-check-inline">
                            <label class="form-check-label">
                                <input type="radio" class="form-check-input mr-2" name="stop">Any
                            </label>
                        </div>
                        <div class="divider-15 d-block d-md-none"></div>
                        <div class="form-check-inline">
                            <label class="form-check-label">
                                <input type="radio" class="form-check-input mr-2" name="stop">Nonestop (Direct Flights)
                            </label>
                        </div>
                        <div class="divider-15 d-block d-md-none"></div>
                        <div class="form-check-inline">
                            <label class="form-check-label">
                                <input type="radio" class="form-check-input mr-2" name="stop">1 Stop
                            </label>
                        </div>
                        <div class="divider-15 d-block d-md-none"></div>
                        <div class="form-check-inline">
                            <label class="form-check-label">
                                <input type="radio" class="form-check-input mr-2" name="stop">2+ Stops
                            </label>
                        </div>
                        <div class="divider-30 d-block d-md-none"></div>
                        <label class="mr-4"><strong>Layover:</strong></label>
                        <br class="d-block d-md-none">
                        <div class="divider-30 d-block d-md-none"></div>
                        <div class="slider-red slider-holder d-inline-block mr-4">
                            <input id="stopover" type="text" value="" class="form-control">
                        </div>
                        <label class="stopover mr-2">2 - 24 hours</label>

                    </div>
                </div>
            </div>
            <div class="modal fade" id="passengersModal" tabindex="-1" role="dialog"
                 aria-labelledby="passengersModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content" style="top: 5%;">
                        <div class="modal-header">
                            <h6 class="modal-title" id="passengersModalLabel">Passengers</h6>
                        </div>
                        <div class="modal-body">
                <span style="padding: 0 2%">

                    <div class="container">
                      <div class="row">
                        <div class="col-sm">
                          Adults
                        </div>
                        <div class="col-sm">
                          <input type="button" class="increment" value="-" @click="decrement(1)"
                                 id="valAdultsDecrement"/>

                              <input type="text" readonly
                                     style="padding: 1% 2%; width: 15%; border: none; text-align: center"
                                     v-model="form.valAdults" id="valAdults"/>
                           <input type="button" class="increment" id="valAdultsIncrement" value="+"
                                  @click="increment(1)"/>
                        </div>
                      </div>
                    </div>

                    <div class="dropdown-divider"></div>
                    <div class="container">
                      <div class="row">
                        <div class="col-sm">
                          Children
                        </div>
                        <div class="col-sm">
                          <input type="button" class="increment" value="-" @click="decrement(2)"
                                 id="valChildrenDecrement"/>

                              <input type="text" readonly
                                     style="padding: 1% 2%; width: 15%; border: none; text-align: center"
                                     v-model="form.valChildren" id="valChildren"/>
                           <input type="button" class="increment" value="+" @click="increment(2)"
                                  id="valChildrenIncrement"/>
                        </div>
                      </div>
                    </div>
                    <div class="dropdown-divider"></div>
                 <div class="container">
                      <div class="row">
                        <div class="col-sm">
                          Infants
                        </div>
                        <div class="col-sm">
                          <input type="button" class="increment" value="-" @click="decrement(3)"
                                 id="valInfantsDecrement"/>

                              <input type="text" readonly
                                     style="padding: 1% 2%; width: 15%; border: none; text-align: center"
                                     v-model="form.valInfants" id="valInfants"/>
                          <input type="button" class="increment" value="+" @click="increment(3)"
                                 id="valInfantsIncrement"/>
                        </div>
                      </div>
                    </div>
                </span>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn" style="width: 50%; background: aliceblue;"
                                    data-dismiss="modal">Close
                            </button>
                            <button type="button" class="btn" style="width: 50%; background: #00B7FF;color: #fff"
                                    data-dismiss="modal">Save changes
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section style="padding-bottom: 50px; background-color: #F7F9FF; padding-top: 30px; ">
        <div class="results-page">
            <div class="container results-container">
                <div class="row">
                    <div class="col-xl-3">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title mb-4">
                                    <h4 class="bold p-0 mt-0" style="font-size: 1.2rem; font-weight: 600;">Subscribe to
                                        Wanderift Lift or Pro and Save</h4>
                                </div>
                                <h5 class="bold m-0 mb-2" style="font-weight: 600; padding-bottom: 5px;">Wanderift
                                    Lite</h5>
                                <h6 class="bold m-0 mb-2" style="padding-bottom: 10px;"><span class="text-primary"
                                                                                              style="color: #00B7FF;">3</span>
                                    Flights <span class="text-primary">$369</span></h6>
                                <p class="" style="font-size: 14px;">- 3 Tokens (3 one-way flights)</p>
                                <p class="" style="font-size: 14px;">- 1 Unused Token Rolls over</p>
                                <p class="" style="font-size: 14px;">- No Long Term Commitment</p>
                                <a href="{% url "how-it-works" %}">
                                    <button class="search_btn btn-block m-0" style="font-weight: bold;">Learn More
                                    </button>
                                </a>
                                <br><br>
                                <h5 class="bold m-0 mb-2" style="font-weight: 600; padding-bottom: 5px;">Wanderift
                                    Pro</h5>
                                <h6 class="bold m-0 mb-2" style="padding-bottom: 10px;"><span
                                        class="text-primary">4</span> Flights <span class="text-primary">$459</span>
                                </h6>
                                <p class="" style="font-size: 14px;">- 4 Tokens (4 one-way flights)</p>
                                <p class="" style="font-size: 14px;">- 2 Unused Token Rolls over</p>
                                <p class="" style="font-size: 14px;">- No Long Term Commitment</p>
                                <a href="{% url "how-it-works" %}">
                                    <button class="search_btn btn-block m-0" style="font-weight: bold;">Learn More
                                    </button>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 search result p-0">
                        {% for flight in data.data %}
                            <div class="result-item mb-2 w-100">
                                <div class="result-block w-100 d-flex justify-content-start pt-3 pb-3"
                                     data-toggle="collapse"
                                     data-target="#result-item{{ flight.local_arrival | iso_date | date:"his" }}">
                                    <div class="price-block d-flex align-items-center pl-3 pr-3">
                                        <div>
                                            <h5>$ {{ flight.price }}</h5>
                                            <p class="small text-muted">1 Adult</p>
                                        </div>
                                    </div>
                                    <div class="flight-info-block d-flex flex-column w-100">
                                        <div class="departure-row d-flex justify-content-start">
                                            <div class="airline-logo-holder d-flex"
                                                 data-stopnum="{{ flight.id }}">
                                                {% for airline in flight.airlines %}
                                                    <div class="img-airline">
                                                        <div class="airline">
                                                            <img src="/images/{{ airline |aircon }}.png"
                                                                 alt="AA" style="width:25px; margin-right: 4px;">
                                                        </div>
                                                    </div>
                                                {% endfor %}
                                            </div>
                                            <div class="d-flex justify-content-around w-100">
                                                <div class="">
                                                    <label class="mb-0"><strong>
                                                        {{ flight.utc_departure | iso_date | date:"P" }} -
                                                        {{ flight.utc_arrival | iso_date | date:"P" }}</strong></label><br>
                                                    <span class="small text-muted">
                                            {{ flight.cityFrom }}
                                            <i class="fa fa-long-arrow-right mr-1 ml-1"></i>
                                            {{ flight.cityTo }}
                                        </span>
                                                </div>
                                                <div class="">
                                                    <label class="mb-0">
                                                        <strong>{{ flight.utc_departure | iso_date | date:"D j M" }}</strong>
                                                    </label>
                                                    <br>
                                                    <span class="small text-muted">0h 55m</span>
                                                </div>
                                                <div></div>
                                            </div>

                                        </div>
                                        <div class="flight-divider d-flex justify-content-start text-left mt-2 mb-2">
                                            <span style="width: 50px; border-bottom: 1px solid silver; height: 12px;"></span>
                                            <p class="small text-muted mb-0 ml-3">
                                                Stays about 2 days in Austin
                                            </p>
                                        </div>


                                        <div class="arrival-row d-flex justify-content-start">
                                            <div class="airline-logo-holder" data-stopnum="1">
                                                <div class="img-airline">
                                                    <div class="airline">
                                                        <img src="/images/{{ flight.airlines|last |aircon }}.png"
                                                             alt="AA" style="width: 25px;">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="d-flex justify-content-around w-100">
                                                <div class="">

                                                    <label class="mb-0"><strong>{{ flight.utc_arrival | iso_date | date:"P" }}
                                                        -
                                                        {{ flight.utc_departure | iso_date | date:"P" }}</strong></label>
                                                    <br>
                                                    <span class="small text-muted">
                                                    {{ flight.cityTo }}
                                                    <i class="fa fa-long-arrow-right mr-1 ml-1"></i>
                                                    {{ flight.cityFrom }}
                                                    </span>
                                                </div>
                                                <div class="">
                                                    <label class="mb-0">
                                                        <strong>{{ flight.utc_arrival | iso_date | date:"D j M" }}</strong>
                                                    </label>
                                                    <br>
                                                    <span class="small text-muted">0h 55m</span>
                                                </div>
                                                <div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="result-details collapse container-fluid"
                                     id="result-item{{ flight.local_arrival | iso_date | date:"his" }}">
                                    <hr class="m-0">
                                    {% for route in flight.route %}
                                    <div class="route-box row">
                                        <div class="col-12 col-md-6 departure-block border-right pt-4 pb-4">
                                            <h6 class="text-muted mb-3">
                                                DEPARTURE
                                                <span class="small ml-2">Duration:</span>
                                                <span class="small">5h 28m</span>
                                            </h6>
                                            <p class="mb-2 dark-text">
                                                <strong class="">
                                                    <i class="fa fa-calendar mr-2"></i>
                                                    Thu Sep 19
                                                </strong>
                                            </p>
                                            <div class="d-flex align-items-center position-relative">
                                                <i class="fa fa-plane mr-2 w-10 text-muted rotated-plane-icon"></i>
                                                <div class="card w-100 cursor-pointer" data-toggle="collapse"
                                                     data-target="#airplane1">
                                                    <div class="card-body p-0">
                                                        <div class="d-flex justify-content-between pl-2">
                                                            <div class="mr-auto">
                                                                <div class="airlines-labels">
                                                                    <label class="mb-0">
                                                                        <span class="dark-text">6:00 AM</span>
                                                                        <span class="text-muted">Los Angeles LAX</span>
                                                                    </label>
                                                                    <br>
                                                                    <label class="mb-0">
                                                                        <span class="dark-text">7:14 AM</span>
                                                                        <span class="text-muted">Las Vegas LAS</span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                            <div class="d-flex">
                                                                <img src="/images/jetblue.png" alt="Airline"
                                                                     class="align-self-center" height="32px">
                                                            </div>
                                                            <div class="col-1 text-right d-flex">
                                                                <img src="{% static "images/arrow.png" %}"
                                                                     style="width: 10px; height: 5px;"
                                                                    class="align-self-center">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="card-footer collapse" id="airplane1">
                                                        <span class="text-muted small mb-4">FLIGHT INFO</span>
                                                        <div class="d-inline-flex justify-content-between w-100">
                                                            <label>Flight No.</label>
                                                            <label class="text-grey">{{ route.flight_no }}
                                                            </label>
                                                        </div>
                                                        <div class="d-inline-flex justify-content-between w-100">
                                                            <label>Seats Remaining</label>
                                                            <label class="text-grey">{{ flight.availability.seats }}
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span class="position-absolute duration-indicator small text-muted">1h 14m</span>
                                            </div>
                                            <div class="d-flex pt-3 pl-4 pb-3">
                                                <i class="fa fa-clock-o mr-2"></i>
                                                <p class="small text-muted mb-0">1h 26m layover</p>
                                            </div>
                                             <div class="d-flex align-items-center position-relative">
                                                <i class="fa fa-plane mr-2 w-10 text-muted rotated-plane-icon"></i>
                                                <div class="card w-100 cursor-pointer" data-toggle="collapse"
                                                     data-target="#airplane2">
                                                    <div class="card-body p-0">
                                                        <div class="d-flex justify-content-between pl-2">
                                                            <div class="mr-auto">
                                                                <div class="airlines-labels">
                                                                    <label class="mb-0">
                                                                        <span class="dark-text">6:00 AM</span>
                                                                        <span class="text-muted">Las Vegas LAS</span>
                                                                    </label>
                                                                    <br>
                                                                    <label class="mb-0">
                                                                        <span class="dark-text">7:14 AM</span>
                                                                        <span class="text-muted">Seattle SEA</span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                            <div class="d-flex">
                                                                <img src="/images/spirit.png" alt="Airline"
                                                                     class="align-self-center" height="32px">
                                                            </div>
                                                            <div class="col-1 text-right d-flex">
                                                                <img src="{% static "images/arrow.png" %}"
                                                                     style="width: 10px; height: 5px;"
                                                                    class="align-self-center">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="card-footer collapse" id="airplane2">
                                                        <span class="text-muted small mb-4">FLIGHT INFO</span>
                                                        <div class="d-inline-flex justify-content-between w-100">
                                                            <label>Flight No.</label>
                                                            <label class="text-grey">{{ route.flight_no }}
                                                            </label>
                                                        </div>
                                                        <div class="d-inline-flex justify-content-between w-100">
                                                            <label>Seats Remaining</label>
                                                            <label class="text-grey">{{ flight.availability.seats }}
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                 <span class="position-absolute duration-indicator small text-muted">1h 14m</span>
                                            </div>
                                            <div class="d-flex pt-3 pl-4 pb-3">
                                                <i class="fa fa-bed mr-2"></i>
                                                <p class="small text-muted mb-0">5 nights in Seattle</p>
                                            </div>
                                        </div>
                                        <div class="col-12 col-md-6 return-block pt-4">
                                            <h6 class="text-muted mb-3">
                                                RETURN
                                                <span class="small ml-2">Duration:</span>
                                                <span class="small">5h 28m</span>
                                            </h6>
                                            <p class="mb-2 dark-text">
                                                <strong class="">
                                                    <i class="fa fa-calendar mr-2"></i>
                                                    Thu Sep 19
                                                </strong>
                                            </p>
                                            <div class="d-flex align-items-center position-relative">
                                                <i class="fa fa-plane mr-2 w-10 text-muted rotated-plane-icon"></i>
                                                <div class="card w-100 cursor-pointer" data-toggle="collapse"
                                                     data-target="#airplane3">
                                                    <div class="card-body p-0">
                                                        <div class="d-flex justify-content-between pl-2">
                                                            <div class="mr-auto">
                                                                <div class="airlines-labels">
                                                                    <label class="mb-0">
                                                                        <span class="dark-text">6:00 AM</span>
                                                                        <span class="text-muted">Los Angeles LAX</span>
                                                                    </label>
                                                                    <br>
                                                                    <label class="mb-0">
                                                                        <span class="dark-text">7:14 AM</span>
                                                                        <span class="text-muted">Las Vegas LAS</span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                            <div class="d-flex">
                                                                <img src="/images/jetblue.png" alt="Airline"
                                                                     class="align-self-center" height="32px">
                                                            </div>
                                                            <div class="col-1 text-right d-flex">
                                                                <img src="{% static "images/arrow.png" %}"
                                                                     style="width: 10px; height: 5px;"
                                                                    class="align-self-center">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="card-footer collapse" id="airplane3">
                                                        <span class="text-muted small mb-4">FLIGHT INFO</span>
                                                        <div class="d-inline-flex justify-content-between w-100">
                                                            <label>Flight No.</label>
                                                            <label class="text-grey">{{ route.flight_no }}
                                                            </label>
                                                        </div>
                                                        <div class="d-inline-flex justify-content-between w-100">
                                                            <label>Seats Remaining</label>
                                                            <label class="text-grey">{{ flight.availability.seats }}
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <span class="position-absolute duration-indicator small text-muted">1h 14m</span>
                                            </div>
                                            <div class="d-flex pt-3 pl-4 pb-3">
                                                <i class="fa fa-clock-o mr-2"></i>
                                                <p class="small text-muted mb-0">1h 26m layover</p>
                                            </div>
                                             <div class="d-flex align-items-center position-relative">
                                                <i class="fa fa-plane mr-2 w-10 text-muted rotated-plane-icon"></i>
                                                <div class="card w-100 cursor-pointer" data-toggle="collapse"
                                                     data-target="#airplane4">
                                                    <div class="card-body p-0">
                                                        <div class="d-flex justify-content-between pl-2">
                                                            <div class="mr-auto">
                                                                <div class="airlines-labels">
                                                                    <label class="mb-0">
                                                                        <span class="dark-text">6:00 AM</span>
                                                                        <span class="text-muted">Las Vegas LAS</span>
                                                                    </label>
                                                                    <br>
                                                                    <label class="mb-0">
                                                                        <span class="dark-text">7:14 AM</span>
                                                                        <span class="text-muted">Seattle SEA</span>
                                                                    </label>
                                                                </div>
                                                            </div>
                                                            <div class="d-flex">
                                                                <img src="/images/spirit.png" alt="Airline"
                                                                     class="align-self-center" height="32px">
                                                            </div>
                                                            <div class="col-1 text-right d-flex">
                                                                <img src="{% static "images/arrow.png" %}"
                                                                     style="width: 10px; height: 5px;"
                                                                    class="align-self-center">
                                                            </div>
                                                        </div>
                                                    </div>
                                                     <div class="card-footer collapse" id="airplane4">
                                                        <span class="text-muted small mb-4">FLIGHT INFO</span>
                                                        <div class="d-inline-flex justify-content-between w-100">
                                                            <label>Flight No.</label>
                                                            <label class="text-grey">{{ route.flight_no }}
                                                            </label>
                                                        </div>
                                                        <div class="d-inline-flex justify-content-between w-100">
                                                            <label>Seats Remaining</label>
                                                            <label class="text-grey">{{ flight.availability.seats }}
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                 <span class="position-absolute duration-indicator small text-muted">1h 14m</span>
                                            </div>
                                            <div class="d-flex pt-3 pl-4 pb-3">
                                                <i class="fa fa-bed mr-2"></i>
                                                <p class="small text-muted mb-0">5 nights in Seattle</p>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                    <div class="search-results-buttons text-right p-2">
                                        <a href="{% url 'subscription' %}">
                                            <button class="search_btn">Subscribe and save
                                                ${{ flight.price |add:"-459" }}</button>
                                        </a>
                                        <a href="{% url 'retail' flight.booking_token %}">
                                            <button class="search_btn book-btn"> Book for ${{ flight.price }}</button>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    <div class="col-xl-3">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title mb-2">
                                    <h5 class="bold p-0 mt-0" style="font-weight: 600;">Filter by Airline</h5>
                                </div>
                                <div class="card-body">
                                    <ul class="p-0">
                                        {% for airline in airlines %}
                                        <li class="pb-3">
                                            <input id="airline1" type="checkbox" class="form-check-input mr-2">
                                            <label for="airline1">
                                                <img class="mr-1" src="/images/{{ airline |aircon }}.png"
                                                     style="width: 25px;"/>
                                                {{ airline | airlines}} Airlines
                                            </label>
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="card filter-by-time mt-3">
                            <div class="card-body">
                                <div class="card-title mb-2">
                                    <h5 class="bold p-0 mt-0" style="font-weight: 600;">Filter by Time</h5>
                                </div>
                                <div class="card-body pr-2">
                                    <ul class="nav d-flex slider-nav">
                                        <li class="nav-item">
                                            <a class="nav-link active" href="#takeoff" data-toggle="tab">Take-off</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="#landing" data-toggle="tab">Landing</a>
                                        </li>
                                    </ul>
                                    <div class="tab-content">
                                        <div class="tab-pane active show" id="takeoff">
                                            <div class="mt-3">Departure City Take-off</div>
                                            <div id="de_city_take_off_time" class="small mb-4">0:00AM - 11:59PM</div>
                                            <div class="slider-red slider-holder">
                                                <input id="de_city_take_off" type="text" value="" class="form-control">
                                            </div>
                                            <div class="mt-3">Arrival City Take-off</div>
                                            <div id="arr_city_take_off_time" class="small mb-4">0:00AM - 11:59PM</div>
                                            <div class="slider-red slider-holder">
                                                <input id="arr_city_take_off" type="text" value="" class="form-control">
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="landing">
                                            <div class="mt-3">Departure City Landing</div>
                                            <div id="de_city_landing_time" class="small mb-4">0:00AM - 11:59PM</div>
                                            <div class="slider-red slider-holder">
                                                <input id="de_city_landing" type="text" value="" class="form-control">
                                            </div>
                                            <div class="mt-3">Arrival City Landing</div>
                                            <div id="arr_city_landing_time" class="small mb-4">0:00AM - 11:59PM</div>
                                            <div class="slider-red slider-holder">
                                                <input id="arr_city_landing" type="text" value="" class="form-control">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="placesModal" tabindex="-1" role="dialog" aria-labelledby="placesModalCenterTitle"
             aria-hidden="true">
            <div class="modal-dialog " role="document">
                <div class="modal-content" style="top: 160px;">
                    <div class="modal-body">
                        <div class="row pop2_first">
                            <div class="col-6" style="text-align:left; margin-bottom: 2%"><p id="placesModalTitle"></p>
                            </div>
                            <div class="col-6" style="text-align:right">
                                <!--  <p style="color:#8092a9; cursor: pointer;"  @click="clearList"><i
                                      class="fa fa-times" style="margin-left:5px"></i></p>--></div>
                        </div>
                        <div class="row pop2_second">
                            <div class="col-12">
                                <div>
                                    <div style="border: 1px solid #00B7FF; border-radius: 5px; padding: 2%">
                                        <div class="search_selected_values">
                                            <button class="sel_place_btn" style="margin: 2%" id="mySelectedPlace">
                                                <i class="fa fa-times-circle" style="margin-right:5px"
                                                   @click="clearPlaceItem(index)"></i>

                                            </button>
                                        </div>

                                        <div class="pop2_hor_line" style="margin:10px 0px"></div>
                                        <input class="pop2_input" type="text" v-model="city" v-on:keyup="cityHandler"
                                               onfocus="this.value=''" placeholder="Add new location..."/>
                                    </div>

                                    <ol class="search_result_list">
                                        <li v-for="(place, index) of searchResultPlaces">
                                            <button class="btn search_result_list_item"
                                                    @click="setPlace(place.nameCity,place.codeIataCity,index)">
                                                <i class="fa fa-building" style="padding-right: 2%"></i>
                                                <i class="fa fa-plane" style="padding-right: 2%" :hidden="true"></i>
                                                {( place.nameCity )}
                                            </button>
                                        </li>
                                    </ol>

                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="modal-footer">
                        <button class="pop2_footer_left" data-dismiss="modal">Cancel</button>
                        <button class="pop2_footer_right" @click="choosePlaces">Choose</button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    {% include "_includes/footer.html" %}
{% endblock %}


{% block jscontent %}
    <script src="{% static "js/home.js" %}"></script>
    <script src="{% static "js/lightpick.js" %}"></script>
    <script src="{% static "js/bootstrap-slider.js" %}"></script>

    <script>
        $(document).ready(function () {
            var Stopover = new Slider("input#stopover", {
                min: 2,
                max: 24,
                step: 1,
                value: [2, 24],
                tooltip: "hide",
                formatter: stopover
            });
            Stopover.on('slideStop', function () {
            }).on('slide', function () {
                stopover(Stopover.getValue());
            });
        });

        function stopover(val) {
            if (Array.isArray(val)) {
                $(".stopover").text(val[0] + ' - ' + val[1] + ' hours');
            } else {
                //$(".stopover").text(val + ' hours');
            }
        }

        $(document).ready(function () {
            var DeCityTakeOff = new Slider("input#de_city_take_off", {
                min: 0,
                max: 1440,
                step: 15,
                value: [0, 1440],
                tooltip: "hide",
                formatter: timeFormatter
            });
            DeCityTakeOff.on('slideStop', function () {
                var range = getTime(DeCityTakeOff.getValue());
                if (Array.isArray(range)) {
                    app.timeFilterParams.depTake.min = range[0];
                    app.timeFilterParams.depTake.max = range[1];
                }
                app.filterByTimes();
            }).on('slide', function () {
                $("#de_city_take_off_time").text(timeFormatter(DeCityTakeOff.getValue()));
            });
            var ArrCityTakeOff = new Slider("input#arr_city_take_off", {
                min: 0,
                max: 1440,
                step: 15,
                value: [0, 1440],
                tooltip: "hide",
                formatter: timeFormatter
            });
            ArrCityTakeOff.on('slideStop', function () {
                var range = getTime(ArrCityTakeOff.getValue());
                if (Array.isArray(range)) {
                    app.timeFilterParams.arrTake.min = range[0];
                    app.timeFilterParams.arrTake.max = range[1];
                }
                app.filterByTimes();
            }).on('slide', function () {
                $("#arr_city_take_off_time").text(timeFormatter(ArrCityTakeOff.getValue()));
            });
            var DeCityLanding = new Slider("input#de_city_landing", {
                min: 0,
                max: 1440,
                step: 15,
                value: [0, 1440],
                tooltip: "hide",
                formatter: timeFormatter
            });
            DeCityLanding.on('slideStop', function () {
                var range = getTime(DeCityLanding.getValue());
                if (Array.isArray(range)) {
                    app.timeFilterParams.depLand.min = range[0];
                    app.timeFilterParams.depLand.max = range[1];
                }
                app.filterByTimes();
            }).on('slide', function () {
                $("#de_city_landing_time").text(timeFormatter(DeCityLanding.getValue()));
            });
            var ArrCityLanding = new Slider("input#arr_city_landing", {
                min: 0,
                max: 1440,
                step: 15,
                value: [0, 1440],
                tooltip: "hide",
                formatter: timeFormatter
            });
            ArrCityLanding.on('slideStop', function () {
                var range = getTime(ArrCityLanding.getValue());
                if (Array.isArray(range)) {
                    app.timeFilterParams.arrLand.min = range[0];
                    app.timeFilterParams.arrLand.max = range[1];
                }
                app.filterByTimes();
            }).on('slide', function () {
                $("#arr_city_landing_time").text(timeFormatter(ArrCityLanding.getValue()));
            });
        });

        function getTime(val) {
            if (Array.isArray(val)) {
                var time = ['00:00', '23:59'];
                var hour = Math.floor(val[0] / 60);
                var minute = val[0] - hour * 60;
                time[0] = (hour >= 10 ? hour : '0' + hour) + ':' + (minute >= 10 ? minute : '0' + minute);
                hour = Math.floor(val[1] / 60);
                minute = val[1] - hour * 60;
                time[1] = (hour >= 10 ? hour : '0' + hour) + ':' + (minute >= 10 ? minute : '0' + minute);
                return time;
            }
            return null;
        }

        function timeFormatter(val) {
            if (Array.isArray(val)) {
                var hours1 = Math.floor(val[0] / 60);
                var minutes1 = val[0] - hours1 * 60;

                if (hours1.length == 1) hours1 = '0' + hours1;
                if (minutes1.length == 1) minutes1 = '0' + minutes1;
                if (minutes1 == 0) minutes1 = '00';
                if (hours1 >= 12) {
                    if (hours1 == 12) {
                        hours1 = hours1;
                        minutes1 = minutes1 + " PM";
                    } else {
                        hours1 = hours1 - 12;
                        minutes1 = minutes1 + " PM";
                    }
                } else {
                    hours1 = hours1;
                    minutes1 = minutes1 + " AM";
                }
                if (hours1 == 0) {
                    //hours1 = 12;
                    minutes1 = minutes1;
                }
                var minTime = hours1 + ':' + minutes1;

                var hours2 = Math.floor(val[1] / 60);
                var minutes2 = val[1] - hours2 * 60;

                if (hours2.length == 1) hours2 = '0' + hours2;
                if (minutes2.length == 1) minutes2 = '0' + minutes2;
                if (minutes2 == 0) minutes2 = '00';
                if (hours2 >= 12) {
                    if (hours2 == 12) {
                        hours2 = hours2;
                        minutes2 = minutes2 + " PM";
                    } else if (hours2 == 24) {
                        hours2 = 11;
                        minutes2 = "59 PM";
                    } else {
                        hours2 = hours2 - 12;
                        minutes2 = minutes2 + " PM";
                    }
                } else {
                    hours2 = hours2;
                    minutes2 = minutes2 + " AM";
                }

                var maxTime = hours2 + ':' + minutes2;
                return minTime + " - " + maxTime;
            } else {
                var hour = Math.floor(val / 60);
                var minute = val - hour * 60;

                if (hour.length == 1) hour = '0' + hour;
                if (minute.length == 1) minute = '0' + minute;
                if (minute == 0) minute = '00';
                if (hour >= 12) {
                    if (hour == 12) {
                        hour = hour;
                        minute = minute + " PM";
                    } else {
                        hour = hour - 12;
                        minute = minute + " PM";
                    }
                } else {
                    hour = hour;
                    minute = minute + " AM";
                }
                if (hour == 0) {
                    //hour = 12;
                    minute = minute;
                }
                return hour + ':' + minute;
            }
        }

        let tripButton = document.querySelector(".btn-group");
        let picker = new Lightpick({
            field: document.getElementById('departure_date'),
            secondField: document.getElementById('return_date'),
            singleDate: false,
            onSelect: function (start, end) {
                var str = '';
                str += start ? start.format('Do MMMM YYYY') + ' to ' : '';
                str += end ? end.format('Do MMMM YYYY') : '...';
                {#document.getElementById('result-3').innerHTML = str;#}
            }
        });
    </script>
{% endblock %}
